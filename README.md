# å®å¯æ¢¦å¡ç‰‡çˆ¬è™«

ä½¿ç”¨ Puppeteer v24.10.0 å¼€å‘çš„å®å¯æ¢¦å¡ç‰‡æ•°æ®çˆ¬è™«ï¼Œç”¨äºæŠ“å– https://asia.pokemon-card.com ç½‘ç«™ä¸Šçš„å¡ç‰‡ä¿¡æ¯ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… å¯åŠ¨ Puppeteer æµè§ˆå™¨å¹¶æ‰“å¼€ç›®æ ‡é¡µé¢
- âœ… ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆï¼Œé€‰å– `rightColumn` å…ƒç´ 
- âœ… è·å–æ‰€æœ‰ `card` ç±»çš„ `<li>` å…ƒç´ 
- âœ… æå–æ¯ä¸ªå¡ç‰‡çš„è¯¦æƒ…é¡µé“¾æ¥
- âœ… å°†ç›¸å¯¹é“¾æ¥è½¬æ¢ä¸ºå®Œæ•´é“¾æ¥
- âœ… é€ä¸ªè®¿é—®å¡ç‰‡è¯¦æƒ…é¡µé¢å¹¶æå–å®Œæ•´æ•°æ®
- âœ… æ”¯æŒèƒ½é‡ç±»å‹å›¾ç‰‡åˆ°ä¸­æ–‡æ–‡æœ¬çš„æ˜ å°„
- âœ… æå–å¡ç‰‡çš„æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ï¼ˆåç§°ã€å±æ€§ã€æ‹›å¼ã€å›¾é‰´ç­‰ï¼‰
- âœ… è‡ªåŠ¨ä¸‹è½½å¡ç‰‡é«˜æ¸…å›¾ç‰‡åˆ°æœ¬åœ°
- âœ… æ¸è¿›å¼å†™å…¥ JSONL æ ¼å¼æ–‡ä»¶ï¼ˆå®æ—¶ä¿å­˜ï¼Œæ–­ç‚¹ç»­ä¼ å‹å¥½ï¼‰
- âœ… å›¾é‰´ç¼–å·è‡ªåŠ¨è¡¥é›¶æ ¼å¼åŒ–ï¼ˆå¦‚ï¼š0001ã€0025ï¼‰
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†å’Œèµ„æºæ¸…ç†æœºåˆ¶

## å®‰è£…ä¾èµ–

```bash
cd puppeteer
npm install
```

## ä½¿ç”¨æ–¹æ³•

### åŸºç¡€è¿è¡Œ
```bash
npm start
```

### å¼€å‘æ¨¡å¼ï¼ˆå¸¦è°ƒè¯•ï¼‰
```bash
npm run dev
```

## ä»£ç ç»“æ„

```
puppeteer/
â”œâ”€â”€ package.json        # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ index.js           # ä¸»çˆ¬è™«ä»£ç 
â””â”€â”€ README.md          # è¯´æ˜æ–‡æ¡£
```

## ä¸»è¦ç±»å’Œæ–¹æ³•

### PokemonCardCrawler ç±»

- `init()` - åˆå§‹åŒ–æµè§ˆå™¨å’Œé¡µé¢
- `getCardLinks()` - è·å–å¡ç‰‡åˆ—è¡¨é¡µé¢çš„æ‰€æœ‰å¡ç‰‡é“¾æ¥
- `visitCardDetail(cardUrl)` - è®¿é—®å•ä¸ªå¡ç‰‡è¯¦æƒ…é¡µé¢
- `visitAllCardDetails(cardLinks)` - æ‰¹é‡è®¿é—®æ‰€æœ‰å¡ç‰‡è¯¦æƒ…é¡µé¢
- `cleanup()` - æ¸…ç†æµè§ˆå™¨èµ„æº

## é…ç½®é€‰é¡¹

### æµè§ˆå™¨é…ç½®
- `headless: false` - æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼ˆä¾¿äºè°ƒè¯•ï¼‰
- `defaultViewport` - è®¾ç½®è§†å£å¤§å°ä¸º 1280x720
- åŒ…å«é˜²æ£€æµ‹çš„å¯åŠ¨å‚æ•°

### è¯·æ±‚ç­–ç•¥
- ä½¿ç”¨ `networkidle2` ç­‰å¾…ç­–ç•¥ç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½
- å†…ç½®éšæœºå»¶è¿Ÿï¼ˆ1-3ç§’ï¼‰é¿å…è¢«åçˆ¬è™«
- è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ï¼ˆ30ç§’ï¼‰

## è¿è¡Œæµç¨‹

1. **å¯åŠ¨é˜¶æ®µ**ï¼šåˆå§‹åŒ– Puppeteer æµè§ˆå™¨
2. **é¡µé¢åŠ è½½**ï¼šæ‰“å¼€ç›®æ ‡é¡µé¢å¹¶ç­‰å¾…åŠ è½½å®Œæˆ
3. **å…ƒç´ å®šä½**ï¼šæŸ¥æ‰¾ `div.rightColumn` å…ƒç´ 
4. **é“¾æ¥æå–**ï¼šè·å–æ‰€æœ‰ `li.card` ä¸­çš„ `<a>` æ ‡ç­¾ href å±æ€§
5. **é“¾æ¥è½¬æ¢**ï¼šå°†ç›¸å¯¹è·¯å¾„è½¬æ¢ä¸ºå®Œæ•´ URL
6. **ç»“æœè¾“å‡º**ï¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºæ‰€æœ‰æ‰¾åˆ°çš„å¡ç‰‡é“¾æ¥

## æ•°æ®ç»“æ„

æ¯ä¸ªå¡ç‰‡çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š

```json
{
  "card_id": "hk00008497",
  "card_type": "åŸºç¤",
  "name": {
    "zh": "ä¿æ¯æ›¼æ³¢",
    "en": null
  },
  "dex_info": {
    "national_no": "0594",
    "category": "çœ‹è­·å¯¶å¯å¤¢",
    "height": "1.2m",
    "weight": "31.6kg"
  },
  "stats": {
    "hp": 120
  },
  "attributes": {
    "weakness": "é›·Ã—2",
    "resistance": "ç„¡",
    "retreat_cost": 2
  },
  "abilities": [
    {
      "name": "è¡æµª",
      "type": "æ°´",
      "damage": 30,
      "effect": null
    }
  ],
  "card_info": {
    "illustrator": "Shinji Kanda",
    "card_number": "G SVAW F 001/023",
    "rarity": "Fç¨€æœ‰",
    "set": "æœ±&ç´«"
  },
  "flavor_text": "æœƒç”¨é­šé°­æº«æŸ”åœ°æŠ±ä½å—å‚·æˆ–æ˜¯è™›å¼±çš„å¯¶å¯å¤¢ï¼Œä¸¦ç”¨ç‰¹æ®Šçš„é»è†œåŠ ä»¥æ²»ç™‚ã€‚",
  "appearance": null,
  "image_path": "cardImages/hk00008497.jpg"
}
```

## ç¤ºä¾‹è¾“å‡º

```
=== å®å¯æ¢¦å¡ç‰‡æ•°æ®çˆ¬è™«å¯åŠ¨ ===

è¿›è¡Œåˆå§‹åŒ–è®¾ç½®...
æ­£åœ¨å¯åŠ¨ Puppeteer...
Puppeteer å¯åŠ¨å®Œæˆ
æ­£åœ¨æ‰“å¼€é¡µé¢: https://asia.pokemon-card.com/hk/card-search/list/?expansionCodes=SVAW
é¡µé¢åŠ è½½å®Œæˆï¼Œç­‰å¾…å†…å®¹æ¸²æŸ“...
æ‰¾åˆ° rightColumn å…ƒç´ ï¼Œå¼€å§‹æå–å¡ç‰‡é“¾æ¥...
æˆåŠŸæå–åˆ° 23 ä¸ªå¡ç‰‡é“¾æ¥:
1. https://asia.pokemon-card.com/hk/card-search/detail/8497/
2. https://asia.pokemon-card.com/hk/card-search/detail/8498/
...

--- å¼€å§‹é€ä¸ªå¤„ç†å¡ç‰‡ï¼Œç»“æœå°†å®æ—¶å†™å…¥ pokemon_cards_SVAW.jsonl ---

[1/23] âœ… å·²æŠ“å–å¹¶ä¿å­˜: ä¿æ¯æ›¼æ³¢ (hk00008497)
[2/23] âœ… å·²æŠ“å–å¹¶ä¿å­˜: è¢å…‰é­š (hk00008498)
[3/23] âœ… å·²æŠ“å–å¹¶ä¿å­˜: éœ“è™¹é­š (hk00008499)
...

ğŸ‰ å…¨éƒ¨æ“ä½œå®Œæˆï¼æ•°æ®å·²ä¿å­˜åœ¨ pokemon_cards_SVAW.jsonlï¼Œå›¾ç‰‡å·²ä¿å­˜åœ¨ cardImages ç›®å½•ã€‚

æ­£åœ¨å…³é—­æµè§ˆå™¨...
æµè§ˆå™¨å·²å…³é—­

=== çˆ¬è™«è¿è¡Œå®Œæˆ ===
```

## èƒ½é‡ç±»å‹æ˜ å°„

çˆ¬è™«å†…ç½®äº†èƒ½é‡ç±»å‹å›¾ç‰‡åˆ°ä¸­æ–‡æ–‡æœ¬çš„æ˜ å°„è¡¨ï¼š

```javascript
const energyMap = {
    'Water.png': 'æ°´',
    'Lightning.png': 'é›»',
    'Colorless.png': 'ç„¡è‰²',
    'Fighting.png': 'é¬¥',
    'Psychic.png': 'è¶…',
    'Fire.png': 'ç«',
    'Grass.png': 'è‰',
    'Darkness.png': 'æƒ¡',
    'Metal.png': 'é‹¼',
    'Dragon.png': 'é¾',
    'Fairy.png': 'å¦–',
};
```

## è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ç›®æ ‡ç½‘å€

åœ¨ `PokemonCardCrawler` æ„é€ å‡½æ•°ä¸­ä¿®æ”¹ `targetUrl`ï¼š

```javascript
constructor() {
    // ... å…¶ä»–é…ç½®
    this.targetUrl = 'https://asia.pokemon-card.com/hk/card-search/list/?expansionCodes=YOUR_CODE';
}
```

### ä¿®æ”¹è¾“å‡ºæ–‡ä»¶å

åœ¨ `run()` æ–¹æ³•ä¸­è°ƒç”¨ `saveData()` æ—¶ä¼ å…¥è‡ªå®šä¹‰æ–‡ä»¶åï¼š

```javascript
await this.saveData('custom_filename.json');
```

### è°ƒæ•´çˆ¬å–å»¶è¿Ÿ

åœ¨ `visitAllCardDetails()` æ–¹æ³•ä¸­ä¿®æ”¹å»¶è¿Ÿæ—¶é—´ï¼š

```javascript
// æ·»åŠ å»¶è¿Ÿé¿å…è¢«åçˆ¬è™«ï¼ˆ1-3ç§’éšæœºå»¶è¿Ÿï¼‰
await this.delay(1000 + Math.random() * 2000);
```

## æ³¨æ„äº‹é¡¹

- è¯·éµå®ˆç½‘ç«™çš„ robots.txt å’Œä½¿ç”¨æ¡æ¬¾
- å»ºè®®åœ¨è¯·æ±‚é—´æ·»åŠ é€‚å½“å»¶è¿Ÿï¼Œé¿å…å¯¹æœåŠ¡å™¨é€ æˆè¿‡å¤§å‹åŠ›
- å½“å‰ç‰ˆæœ¬ä»…æŠ“å–é“¾æ¥ï¼Œå…·ä½“æ•°æ®æŠ“å–é€»è¾‘éœ€è¦æ ¹æ®å®é™…éœ€æ±‚å¼€å‘
- å¦‚é‡åˆ°åçˆ¬è™«æœºåˆ¶ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´è¯·æ±‚ç­–ç•¥

## æŠ€æœ¯æ ˆ

- **Node.js** - è¿è¡Œç¯å¢ƒ
- **Puppeteer v24.10.1** - æ— å¤´æµè§ˆå™¨æ§åˆ¶
- **ES Modules** - æ¨¡å—ç³»ç»Ÿ 